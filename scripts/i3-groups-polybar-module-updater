#!/usr/bin/env python3
import subprocess

import i3ipc


def _update_polybar(*_):
    subprocess.run(['polybar-msg', 'hook', 'i3-mod', '1'], check=False)


def main():
    _update_polybar()
    i3 = i3ipc.Connection()
    i3.on('workspace::focus', _update_polybar)
    i3.on('workspace::init', _update_polybar)
    i3.on('workspace::rename', _update_polybar)
    i3.on('workspace::move', _update_polybar)
    i3.on('workspace::empty', _update_polybar)
    i3.main()


if __name__ == '__main__':
    main()
